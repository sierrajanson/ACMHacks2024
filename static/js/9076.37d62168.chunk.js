"use strict";(self.webpackChunkbox=self.webpackChunkbox||[]).push([[9076],{71976:(t,e,r)=>{r.d(e,{A:()=>i});class i{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const e=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,e}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}peekLast(){return 0===this.size?null:this._buffer[(this._start+(this.size-1))%this.maxSize]}find(t){if(0===this.size)return null;for(const e of this._buffer)if(null!=e&&t(e))return e;return null}clear(t){let e=this.dequeue();for(;null!=e;)t&&t(e),e=this.dequeue()}}},51703:(t,e,r)=>{r.d(e,{F:()=>c,l:()=>l});var i=r(28899),s=r(81806);const n=128e3;let o=null,a=null;async function c(){return o||(o=async function(){const t=(0,s.A)("esri-csp-restrictions")?await r.e(7879).then(r.bind(r,27879)).then((t=>t.l)):await r.e(6821).then(r.bind(r,56821)).then((t=>t.l));a=await t.default({locateFile:t=>(0,i.s)(`esri/core/libs/libtess/${t}`)})}()),o}function l(t,e){const r=Math.max(t.length,n);return a.triangulate(t,e,r)}},81377:(t,e,r)=>{r.d(e,{V:()=>l});var i=r(84735),s=r(16108),n=r(71275),o=r(47904),a=r(401);const c=96/72;class l{static executeEffects(t,e,r,i){const s=c,l=(0,a.ll)(t);let u=new n.k(e);for(const n of t){const t=(0,o.A)(n);t&&(u=t.execute(u,n,s,r,i,l))}return u}static applyEffects(t,e,r){if(!t)return e;const c=(0,a.ll)(t);let l,u=new n.k(i.z.fromJSONCIM(e));for(const i of t){const t=(0,o.A)(i);t&&(u=t.execute(u,i,1,null,r,c))}const h=[];let p=null;for(;l=u.next();)h.push(...(0,s.x)(l)),p=l.geometryType;return 0===h.length||null===p?null:"esriGeometryPolygon"===p?{rings:h}:{paths:h}}}},33443:(t,e,r)=>{r.d(e,{l:()=>s});var i=r(47904);class s{static getPlacement(t,e,r,s,n,o){const a=(0,i.c)(r);return a?(-1===e&&t.invertY(),a.execute(t,r,s,n,o)):null}}},27307:(t,e,r)=>{r.d(e,{i:()=>f});var i=r(28808),s=r(5095);function n(t,e){return t.x===e.x&&t.y===e.y}function o(t){if(!t)return;const e=t.length;if(e<=1)return;let r=0;for(let i=1;i<e;i++)n(t[i],t[r])||++r===i||(t[r]=t[i]);t.length=r+1}function a(t,e){return t.x=e.y,t.y=-e.x,t}function c(t,e){return t.x=-e.y,t.y=e.x,t}function l(t,e){return t.x=e.x,t.y=e.y,t}function u(t,e){return t.x=-e.x,t.y=-e.y,t}function h(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function p(t,e){return t.x*e.y-t.y*e.x}function x(t,e){return t.x*e.x+t.y*e.y}function d(t,e,r,i){return t.x=e.x*r+e.y*i,t.y=e.x*i-e.y*r,t}class f{constructor(t,e,r){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=r,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._canUseThinTessellation;o(t),r&&e.halfWidth<s.Gh&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const r=e.wrapDistance||65535;let i=e.initialDistance||0,s=!1,n=t[0].x,o=t[0].y;const a=t.length;for(let c=1;c<a;++c){s&&(s=!1,i=0);let e=t[c].x,a=t[c].y,l=e-n,u=a-o,h=Math.sqrt(l*l+u*u);if(l/=h,u/=h,i+h>r){s=!0;const t=(r-i)/h;h=r-i,e=(1-t)*n+t*e,a=(1-t)*o+t*a,--c}const p=this._writeVertex(n,o,0,0,l,u,u,-l,0,-1,i),x=this._writeVertex(n,o,0,0,l,u,-u,l,0,1,i);i+=h;const d=this._writeVertex(e,a,0,0,l,u,u,-l,0,-1,i),f=this._writeVertex(e,a,0,0,l,u,-u,l,0,1,i);this._writeTriangle(p,x,d),this._writeTriangle(x,d,f),n=e,o=a}}_tessellate(t,e){const r=t[0],s=t[t.length-1],o=n(r,s),f=o?3:2;if(t.length<f)return;const y=e.pixelCoordRatio,m=null!=e.capType?e.capType:i.xR.BUTT,_=null!=e.joinType?e.joinType:i.JO.MITER,g=null!=e.miterLimit?Math.min(e.miterLimit,4):2,v=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,w=null!=e.halfWidth?e.halfWidth:2,b=!!e.textured;let k,T,S,P=null;const z=this._prevNormal,E=this._nextNormal;let M=-1,L=-1;const N=this._joinNormal;let R,I;const B=this._textureNormalLeft,A=this._textureNormalRight,D=this._textureNormal;let Y=-1,O=-1;const F=e.wrapDistance||65535;let G=e.initialDistance||0;const C=this._writeVertex,V=this._writeTriangle,U=(t,e,r,i,s,n)=>{const o=C(T,S,R,I,r,i,t,e,s,n,G);return Y>=0&&O>=0&&o>=0&&V(Y,O,o),Y=O,O=o,o};o&&(k=t[t.length-2],E.x=s.x-k.x,E.y=s.y-k.y,L=h(E),E.x/=L,E.y/=L);let W=!1;for(let n=0;n<t.length;++n){if(W&&(W=!1,G=0),k&&(z.x=-E.x,z.y=-E.y,M=L,G+M>F&&(W=!0)),W){const e=(F-G)/M;M=F-G,k={x:(1-e)*k.x+e*t[n].x,y:(1-e)*k.y+e*t[n].y},--n}else k=t[n];T=k.x,S=k.y;const e=n<=0&&!W,r=n===t.length-1;if(e||(G+=M),P=r?o?t[1]:null:t[n+1],P?(E.x=P.x-T,E.y=P.y-S,L=h(E),E.x/=L,E.y/=L):(E.x=void 0,E.y=void 0),!o){if(e){c(N,E),R=N.x,I=N.y,m===i.xR.SQUARE&&(U(-E.y-E.x,E.x-E.y,E.x,E.y,0,-1),U(E.y-E.x,-E.x-E.y,E.x,E.y,0,1)),m===i.xR.ROUND&&(U(-E.y-E.x,E.x-E.y,E.x,E.y,-1,-1),U(E.y-E.x,-E.x-E.y,E.x,E.y,-1,1)),m!==i.xR.ROUND&&m!==i.xR.BUTT||(U(-E.y,E.x,E.x,E.y,0,-1),U(E.y,-E.x,E.x,E.y,0,1));continue}if(r){a(N,z),R=N.x,I=N.y,m!==i.xR.ROUND&&m!==i.xR.BUTT||(U(z.y,-z.x,-z.x,-z.y,0,-1),U(-z.y,z.x,-z.x,-z.y,0,1)),m===i.xR.SQUARE&&(U(z.y-z.x,-z.x-z.y,-z.x,-z.y,0,-1),U(-z.y-z.x,z.x-z.y,-z.x,-z.y,0,1)),m===i.xR.ROUND&&(U(z.y-z.x,-z.x-z.y,-z.x,-z.y,1,-1),U(-z.y-z.x,z.x-z.y,-z.x,-z.y,1,1));continue}}let s,f,C=-p(z,E);if(Math.abs(C)<.01)x(z,E)>0?(N.x=z.x,N.y=z.y,C=1,s=Number.MAX_VALUE,f=!0):(c(N,E),C=1,s=1,f=!1);else{N.x=(z.x+E.x)/C,N.y=(z.y+E.y)/C,s=h(N);const t=(s-1)*w*y;f=s>4||t>M&&t>L}R=N.x,I=N.y;let V=_;switch(_){case i.JO.BEVEL:s<1.05&&(V=i.JO.MITER);break;case i.JO.ROUND:s<v&&(V=i.JO.MITER);break;case i.JO.MITER:s>g&&(V=i.JO.BEVEL)}switch(V){case i.JO.MITER:if(U(N.x,N.y,-z.x,-z.y,0,-1),U(-N.x,-N.y,-z.x,-z.y,0,1),r)break;if(b){const t=W?0:G;Y=this._writeVertex(T,S,R,I,E.x,E.y,N.x,N.y,0,-1,t),O=this._writeVertex(T,S,R,I,E.x,E.y,-N.x,-N.y,0,1,t)}break;case i.JO.BEVEL:{const t=C<0;let e,i,s,n;if(t){const t=Y;Y=O,O=t,e=B,i=A}else e=A,i=B;if(f)s=t?c(this._innerPrev,z):a(this._innerPrev,z),n=t?a(this._innerNext,E):c(this._innerNext,E);else{const e=t?u(this._inner,N):l(this._inner,N);s=e,n=e}const o=t?a(this._bevelStart,z):c(this._bevelStart,z);U(s.x,s.y,-z.x,-z.y,e.x,e.y);const h=U(o.x,o.y,-z.x,-z.y,i.x,i.y);if(r)break;const p=t?c(this._bevelEnd,E):a(this._bevelEnd,E);if(f){const t=this._writeVertex(T,S,R,I,-z.x,-z.y,0,0,0,0,G);Y=this._writeVertex(T,S,R,I,E.x,E.y,n.x,n.y,e.x,e.y,G),O=this._writeVertex(T,S,R,I,E.x,E.y,p.x,p.y,i.x,i.y,G),this._writeTriangle(h,t,O)}else{if(b){const t=this._bevelMiddle;t.x=(o.x+p.x)/2,t.y=(o.y+p.y)/2,d(D,t,-z.x,-z.y),U(t.x,t.y,-z.x,-z.y,D.x,D.y),d(D,t,E.x,E.y),Y=this._writeVertex(T,S,R,I,E.x,E.y,t.x,t.y,D.x,D.y,G),O=this._writeVertex(T,S,R,I,E.x,E.y,n.x,n.y,e.x,e.y,G)}else{const t=Y;Y=O,O=t}U(p.x,p.y,E.x,E.y,i.x,i.y)}if(t){const t=Y;Y=O,O=t}break}case i.JO.ROUND:{const t=C<0;let e,i;if(t){const t=Y;Y=O,O=t,e=B,i=A}else e=A,i=B;const n=t?u(this._inner,N):l(this._inner,N);let o,h;f?(o=t?c(this._innerPrev,z):a(this._innerPrev,z),h=t?a(this._innerNext,E):c(this._innerNext,E)):(o=n,h=n);const p=t?a(this._roundStart,z):c(this._roundStart,z),y=t?c(this._roundEnd,E):a(this._roundEnd,E),m=U(o.x,o.y,-z.x,-z.y,e.x,e.y),_=U(p.x,p.y,-z.x,-z.y,i.x,i.y);if(r)break;const g=this._writeVertex(T,S,R,I,-z.x,-z.y,0,0,0,0,G);f||this._writeTriangle(Y,O,g);const v=u(this._outer,n),w=this._writeVertex(T,S,R,I,E.x,E.y,y.x,y.y,i.x,i.y,G);let k,P;const M=s>2;if(M){let e;s!==Number.MAX_VALUE?(v.x/=s,v.y/=s,e=x(z,v),e=(s*(e*e-1)+1)/e):e=-1,k=t?a(this._startBreak,z):c(this._startBreak,z),k.x+=z.x*e,k.y+=z.y*e,P=t?c(this._endBreak,E):a(this._endBreak,E),P.x+=E.x*e,P.y+=E.y*e}d(D,v,-z.x,-z.y);const L=this._writeVertex(T,S,R,I,-z.x,-z.y,v.x,v.y,D.x,D.y,G);d(D,v,E.x,E.y);const F=b?this._writeVertex(T,S,R,I,E.x,E.y,v.x,v.y,D.x,D.y,G):L,V=g,W=b?this._writeVertex(T,S,R,I,E.x,E.y,0,0,0,0,G):g;let X=-1,H=-1;if(M&&(d(D,k,-z.x,-z.y),X=this._writeVertex(T,S,R,I,-z.x,-z.y,k.x,k.y,D.x,D.y,G),d(D,P,E.x,E.y),H=this._writeVertex(T,S,R,I,E.x,E.y,P.x,P.y,D.x,D.y,G)),b?M?(this._writeTriangle(V,_,X),this._writeTriangle(V,X,L),this._writeTriangle(W,F,H),this._writeTriangle(W,H,w)):(this._writeTriangle(V,_,L),this._writeTriangle(W,F,w)):M?(this._writeTriangle(g,_,X),this._writeTriangle(g,X,H),this._writeTriangle(g,H,w)):(this._writeTriangle(g,_,L),this._writeTriangle(g,F,w)),f?(Y=this._writeVertex(T,S,R,I,E.x,E.y,h.x,h.y,e.x,e.y,G),O=w):(Y=b?this._writeVertex(T,S,R,I,E.x,E.y,h.x,h.y,e.x,e.y,G):m,this._writeTriangle(Y,W,w),O=w),t){const t=Y;Y=O,O=t}break}}}}}},35797:(t,e,r)=>{r.d(e,{uS:()=>C,FE:()=>G,lO:()=>O,XZ:()=>F});r(38983);var i=r(51703),s=r(62032),n=r(1484),o=r(5095);function a(t,e,r,i,s,n,o){R=0;const a=(i-r)*n,l=s&&s.length,h=l?(s[0]-r)*n:a;let p,x,d,f,m,_=c(e,r,i,0,h,n,!0);if(_&&_.next!==_.prev){if(l&&(_=y(e,r,i,s,_,n)),a>80*n){p=d=e[0+r*n],x=f=e[1+r*n];for(let t=n;t<h;t+=n){const i=e[t+r*n],s=e[t+1+r*n];p=Math.min(p,i),x=Math.min(x,s),d=Math.max(d,i),f=Math.max(f,s)}m=Math.max(d-p,f-x),m=0!==m?1/m:0}u(_,t,n,p,x,m,o,0)}}function c(t,e,r,i,s,n,o){let a;if(o===function(t,e,r,i,s,n){let o=0;for(let a=i,c=s-n;a<s;a+=n)o+=(t[c+e*n]-t[a+e*n])*(t[a+1+e*n]+t[c+1+e*n]),c=a;return o}(t,e,0,i,s,n)>0)for(let c=i;c<s;c+=n)a=x(c+e*n,t[c+e*n],t[c+1+e*n],a);else for(let c=s-n;c>=i;c-=n)a=x(c+e*n,t[c+e*n],t[c+1+e*n],a);return a&&T(a,a.next)&&(d(a),a=a.next),a}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t)return t;let r,i=t;do{if(r=!1,i.steiner||!T(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(d(i),i=e=i.prev,i===i.next)break;r=!0}}while(r||i!==e);return e}function u(t,e,r,i,s,n,o,a){if(!t)return;!a&&n&&(t=_(t,i,s,n));let c=t;for(;t.prev!==t.next;){const x=t.prev,f=t.next;if(n?p(t,i,s,n):h(t))e.push(x.index/r+o),e.push(t.index/r+o),e.push(f.index/r+o),d(t),t=f.next,c=f.next;else if((t=f)===c){a?1===a?u(t=P(t,e,r,o),e,r,i,s,n,o,2):2===a&&z(t,e,r,i,s,n,o):u(l(t),e,r,i,s,n,o,1);break}}}function h(t){const e=t.prev,r=t,i=t.next;if(g(e,r,i)>=0)return!1;let s=t.next.next;const n=s;let o=0;for(;s!==t.prev&&(0===o||s!==n);){if(o++,w(e.x,e.y,r.x,r.y,i.x,i.y,s.x,s.y)&&g(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function p(t,e,r,i){const s=t.prev,n=t,o=t.next;if(g(s,n,o)>=0)return!1;const a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,c=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,l=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,u=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,h=k(a,c,e,r,i),p=k(l,u,e,r,i);let x=t.prevZ,d=t.nextZ;for(;x&&x.z>=h&&d&&d.z<=p;){if(x!==t.prev&&x!==t.next&&w(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,d!==t.prev&&d!==t.next&&w(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;x&&x.z>=h;){if(x!==t.prev&&x!==t.next&&w(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&w(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function x(t,e,r,i){const s=L.create(t,e,r);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function d(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function f(t){let e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function y(t,e,r,i,s,n){const o=new Array;for(let a=0,l=i.length;a<l;a++){const s=c(t,e,0,i[a]*n,a<l-1?i[a+1]*n:r*n,n,!1);s===s.next&&(s.steiner=!0),o.push(f(s))}o.sort(S);for(const a of o)s=m(a,s);return s}function m(t,e){const r=function(t,e){let r=e;const i=t.x,s=t.y;let n,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const t=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=i&&t>o){if(o=t,t===i){if(s===r.y)return r;if(s===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===o)return n.prev;const a=n,c=n.x,l=n.y;let u,h=1/0;for(r=n.next;r!==a;)i>=r.x&&r.x>=c&&i!==r.x&&w(s<l?i:o,s,c,l,s<l?o:i,s,r.x,r.y)&&(u=Math.abs(s-r.y)/(i-r.x),(u<h||u===h&&r.x>n.x)&&b(r,t)&&(n=r,h=u)),r=r.next;return n}(t,e);if(!r)return e;const i=M(r,t);return l(i,i.next),l(r,r.next)}function _(t,e,r,i){let s;for(;s!==t;s=s.next){if(s=s||t,null===s.z&&(s.z=k(s.x,s.y,e,r,i)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,_(t,e,r,i);s.prevZ=s.prev,s.nextZ=s.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,r=1;for(;;){let i,s=t;t=null,e=null;let n=0;for(;s;){n++,i=s;let o=0;for(;o<r&&i;o++)i=i.nextZ;let a=r;for(;o>0||a>0&&i;){let r;0===o?(r=i,i=i.nextZ,a--):0!==a&&i?s.z<=i.z?(r=s,s=s.nextZ,o--):(r=i,i=i.nextZ,a--):(r=s,s=s.nextZ,o--),e?e.nextZ=r:t=r,r.prevZ=e,e=r}s=i}if(e.nextZ=null,r*=2,n<2)return t}}(t)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function v(t,e,r,i){return!!(T(t,e)&&T(r,i)||T(t,i)&&T(r,e))||g(t,e,r)>0!=g(t,e,i)>0&&g(r,i,t)>0!=g(r,i,e)>0}function w(t,e,r,i,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(i-a)-(r-o)*(e-a)>=0&&(r-o)*(n-a)-(s-o)*(i-a)>=0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function k(t,e,r,i,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function T(t,e){return t.x===e.x&&t.y===e.y}function S(t,e){return t.x-e.x}function P(t,e,r,i){let s=t;do{const n=s.prev,o=s.next.next;!T(n,o)&&v(n,s,s.next,o)&&b(n,o)&&b(o,n)&&(e.push(n.index/r+i),e.push(s.index/r+i),e.push(o.index/r+i),d(s),d(s.next),s=t=o),s=s.next}while(s!==t);return s}function z(t,e,r,i,s,n,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&E(a,t)){let c=M(a,t);return a=l(a,a.next),c=l(c,c.next),u(a,e,r,i,s,n,o,0),void u(c,e,r,i,s,n,o,0)}t=t.next}a=a.next}while(a!==t)}function E(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let r=t;do{if(r.index!==t.index&&r.next.index!==t.index&&r.index!==e.index&&r.next.index!==e.index&&v(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&b(t,e)&&b(e,t)&&function(t,e){let r=t,i=!1;const s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{r.y>n!=r.next.y>n&&r.next.y!==r.y&&s<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)}function M(t,e){const r=L.create(t.index,t.x,t.y),i=L.create(e.index,e.x,e.y),s=t.next,n=e.prev;return t.next=e,e.prev=t,r.next=s,s.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}class L{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,r){const i=R<N.length?N[R++]:new L;return i.index=t,i.x=e,i.y=r,i.prev=null,i.next=null,i.z=null,i.prevZ=null,i.nextZ=null,i.steiner=!1,i}}const N=[];let R=0;for(let V=0;V<8096;V++)N.push(new L);const I=1e-5,B=new s.O3(0,0,0,1,0),A=new s.O3(0,0,0,1,0);function D(t,e,r){let i=0;for(let s=1;s<r;s++){const r=t[2*(e+s-1)],n=t[2*(e+s-1)+1];i+=(t[2*(e+s)]-r)*(t[2*(e+s)+1]+n)}return i}function Y(t,e,r,i,s){let n=0;for(let o=r;o<i;o+=3){const r=2*(t[o]-s),i=2*(t[o+1]-s),a=2*(t[o+2]-s);n+=Math.abs((e[r]-e[a])*(e[i+1]-e[r+1])-(e[r]-e[i])*(e[a+1]-e[r+1]))}return n}function O(t,e){const{coords:r,lengths:i,hasIndeterminateRingOrder:s}=e,n=t;if(s)return!1;let o=0;for(let c=0;c<i.length;){let t=c,e=i[c],s=D(r,o,e);const l=[];for(;++t<i.length;){const n=i[t],a=D(r,o+e,n);if(!(a>0))break;s+=a,l.push(o+e),e+=n}const u=n.length;a(n,r,o,o+e,l,2,0);const h=Y(n,r,u,n.length,0),p=Math.abs(s);if(Math.abs((h-p)/Math.max(1e-7,p))>I)return n.length=0,!1;c=t,o+=e}return!0}function F(t){const{coords:e,lengths:r}=t,{buffer:s}=(0,i.l)(e,r);return s}function G(t,e){if(null==t)return null;if(!function(t,e,r){let i=0;for(let s=0;s<t.lengths.length;s++){const n=t.lengths[s];for(let s=0;s<n;s++){const n=t.coords[2*(s+i)],o=t.coords[2*(s+i)+1];if(n<e||n>r||o<e||o>r)return!0}i+=n}return!1}(t,-128,o.CQ+128))return t;B.setPixelMargin(e),B.reset(s.dC.Polygon);let r=0;for(let s=0;s<t.lengths.length;s++){const e=t.lengths[s];let i=t.coords[2*(0+r)],n=t.coords[2*(0+r)+1];B.moveTo(i,n);for(let s=1;s<e;s++)i=t.coords[2*(s+r)],n=t.coords[2*(s+r)+1],B.lineTo(i,n);B.close(),r+=e}const i=B.result(!1);if(!i)return null;const a=[],c=[];for(const s of i){let t=0;for(const e of s)c.push(e.x),c.push(e.y),t++;a.push(t)}return new n.A(a,c)}function C(t,e){A.setPixelMargin(e);const r=A,i=-e,n=o.CQ+e;let a=[],c=!1;if(!t.nextPath())return null;let l=!0;for(;l;){t.seekPathStart();const e=[];if(!t.pathSize)return null;r.reset(s.dC.LineString),t.nextPoint();let o=t.x,u=t.y;if(c)r.moveTo(o,u);else{if(o<i||o>n||u<i||u>n){c=!0;continue}e.push({x:o,y:u})}let h=!1;for(;t.nextPoint();)if(o=t.x,u=t.y,c)r.lineTo(o,u);else{if(o<i||o>n||u<i||u>n){h=!0;break}e.push({x:o,y:u})}if(h)c=!0;else{if(c){const t=r.resultWithStarts();if(t)for(const e of t)a.push(e)}else a.push({line:e,start:0});l=t.nextPath(),c=!1}}return a=a.filter((t=>t.line.length>1)),0===a.length?null:a}B.setExtent(o.CQ),A.setExtent(o.CQ)},81320:(t,e,r)=>{r.d(e,{k:()=>o});var i=r(98231),s=r(93345);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{id:{type:s.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.pe.UNSIGNED_BYTE,count:1},pos:{type:s.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:s.pe.FLOAT,count:1,packTessellation:t=>{let{inverseArea:e}=t;return e}}}};class o extends i.N{constructor(){super(...arguments),this.vertexSpec=n}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}}},98231:(t,e,r)=>{r.d(e,{N:()=>c});var i=r(81806),s=r(51703),n=r(35797),o=r(12258);const a=(0,i.A)("featurelayer-fast-triangulation-enabled");class c extends o.r{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,s.F)()])}_write(t,e,r){const i=r?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(i);s&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,s),t.recordEnd())}_clip(t){if(!t)return null;const e=this.hasEffects;return(0,n.FE)(t,e?256:8)}_writeGeometry(t,e,r){const i=r.maxLength>100,s=[],o=this.createTesselationParams(e);if(!i&&a&&(0,n.lO)(s,r))return void(s.length&&this._writeVertices(t,e,r.coords,o,s));const c=(0,n.XZ)(r);this._writeVertices(t,e,c,o)}_writeVertices(t,e,r,i,s){const n=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(s)for(const l of s){const e=r[2*l],s=r[2*l+1];a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,i),c++}else for(let l=0;l<r.length;l+=2){const e=Math.round(r[l]),s=Math.round(r[l+1]);a&&t.recordBounds(e,s,0,0),this._writeVertex(t,n,e,s,i),c++}t.indexEnsureSize(c);for(let l=0;l<c;l++)t.indexWrite(l+o)}}},13308:(t,e,r)=>{r.d(e,{KE:()=>p,KI:()=>u,lB:()=>h,oI:()=>l});var i=r(76931),s=r(55033),n=r(28736),o=r(9410),a=r(90113),c=r(93345);function l(t){const{sprite:e,aspectRatio:r,scaleProportionally:s}=t,n=(0,i.Lz)(t.height),o=n>0?n:e.height;let a=n*r;return a<=0?a=e.width:s&&(a*=e.width/e.height),{width:a,height:o}}function u(t){const{applyRandomOffset:e,sampleAlphaOnly:r}=t;return(0,n.xo)([[a.Fz,e],[a.cn,r]])}const h={createComputedParams:t=>t,optionalAttributes:o.l.optionalAttributes,attributes:{...o.l.attributes,bitset:{count:1,type:c.pe.UNSIGNED_BYTE,pack:u},width:{count:1,type:c.pe.HALF_FLOAT,pack:t=>l(t).width},height:{count:1,type:c.pe.HALF_FLOAT,pack:t=>l(t).height},offset:{count:2,type:c.pe.HALF_FLOAT,pack:t=>{let{offsetX:e,offsetY:r}=t;return[(0,i.Lz)(e),-(0,i.Lz)(r)]}},scale:{count:2,type:c.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:t=>{let{scaleX:e,scaleY:r}=t;return[e,r]}},angle:{count:1,type:c.pe.UNSIGNED_BYTE,pack:t=>{let{angle:e}=t;return(0,s.wV)(e)}}}};class p extends o.m{constructor(){super(...arguments),this.vertexSpec=h}}},33346:(t,e,r)=>{r.d(e,{O:()=>y});var i=r(76931),s=r(84735),n=r(13308),o=r(28736),a=r(38550),c=r(19836),l=r(90113),u=r(93345);const h=n.lB,p=a.e4,x={createComputedParams:t=>t,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,n.KI)(t)},aux1:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,n.oI)(t).width},aux2:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,n.oI)(t).height},aux3:{count:2,type:u.pe.HALF_FLOAT,pack:t=>{let{offsetX:e,offsetY:r}=t;return[(0,i.Lz)(e),(0,i.Lz)(r)]}},aux4:{count:2,type:u.pe.UNSIGNED_BYTE,pack:t=>{let{scaleX:e,scaleY:r}=t;return[e*c.cZ,r*c.cZ]}}}},d={createComputedParams:t=>t,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,color:p.attributes.color,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[l.Xx,!0]])},aux1:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,i.Lz)(.5*t.width)},aux2:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,i.Lz)(.5*t.referenceWidth)},aux3:{count:2,type:u.pe.HALF_FLOAT,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:r}=t;return[e,r]}},aux4:{count:2,type:u.pe.UNSIGNED_BYTE,packTessellation:t=>{let{normalX:e,normalY:r}=t;return[e*c.cZ+c.v9,r*c.cZ+c.v9]}}}};class f extends a.eY{constructor(){super(...arguments),this.vertexSpec=d}}class y extends a.w0{constructor(){super(...arguments),this.vertexSpec=x}_createOutlineWriter(t,e,r,i){return new f(t,e,r,i)}_write(t,e,r){const i=r?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(i);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,r){super.ensurePacked(t,e,r),this._lineMeshWriter.ensurePacked(t,e,r)}enqueueRequest(t,e,r){super.enqueueRequest(t,e,r),this._lineMeshWriter.enqueueRequest(t,e,r)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},13720:(t,e,r)=>{r.d(e,{Y:()=>c,v:()=>a});var i=r(5095),s=r(98231),n=r(28736),o=r(93345);const a={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:o.pe.SHORT,count:2,packPrecisionFactor:i.fq,pack:(t,e)=>{let{scaleInfo:r}=t,{tileInfo:i}=e;return(0,n.My)(r,i)}}},attributes:{id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1},pos:{type:o.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:o.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,n.Jb)(e)}}}};class c extends s.N{constructor(){super(...arguments),this.vertexSpec=a}createTesselationParams(t){return null}}},38550:(t,e,r)=>{r.d(e,{Lm:()=>h,e4:()=>p,eY:()=>x,w0:()=>d});var i=r(84735),s=r(35797),n=r(13720),o=r(28736),a=r(64346),c=r(27534),l=r(90113),u=r(93345);const h={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:u.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,o.Jb)(e)}}}},p={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[l.Xx,!0]])},color:{type:u.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return(0,o.Jb)(e)}}}};class x extends a.Bw{constructor(){super(...arguments),this.vertexSpec=p}}class d extends n.Y{constructor(t,e,r,i){super(t,e,r,i),this.vertexSpec=h,this._lineMeshWriter=this._createOutlineWriter(t,e,r,i)}_createOutlineWriter(t,e,r,i){return new x(t,e,r,i)}_write(t,e,r){const s=r?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(s);n&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,i.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?(0,s.FE)(t,(0,c.Z0)(this.evaluatedMeshParams)):null}ensurePacked(t,e,r){super.ensurePacked(t,e,r),this._lineMeshWriter.ensurePacked(t,e,r)}enqueueRequest(t,e,r){super.enqueueRequest(t,e,r),this._lineMeshWriter.enqueueRequest(t,e,r)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},9410:(t,e,r)=>{r.d(e,{l:()=>o,m:()=>a});var i=r(5095),s=r(13720),n=r(93345);const o={createComputedParams:t=>t,optionalAttributes:s.v.optionalAttributes,attributes:{...s.v.attributes,tlbr:{count:4,type:n.pe.UNSIGNED_SHORT,pack:t=>{let{sprite:e}=t;const{rect:r,width:s,height:n}=e,o=r.x+i.hM,a=r.y+i.hM;return[o,a,o+s,a+n]}},inverseRasterizationScale:{count:1,type:n.pe.BYTE,packPrecisionFactor:16,pack:t=>{let{sprite:e}=t;return 1/e.rasterizationScale}}}};class a extends s.Y{constructor(){super(...arguments),this.vertexSpec=o}_write(t,e,r){const i=r?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(i);if(!s)return;const n=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(t,e,s),t.recordEnd()}}},57156:(t,e,r)=>{r.d(e,{Q:()=>l});var i=r(84735),s=r(38550),n=r(9410);const o={optionalAttributes:n.l.optionalAttributes,createComputedParams:t=>t,attributes:{...n.l.attributes,...s.Lm.attributes}},a={optionalAttributes:n.l.optionalAttributes,createComputedParams:t=>t,attributes:{...n.l.attributes,...s.e4.attributes}};class c extends s.eY{constructor(){super(...arguments),this.vertexSpec=a}}class l extends s.w0{constructor(){super(...arguments),this.vertexSpec=o}_createOutlineWriter(t,e,r,i){return new c(t,e,r,i)}_write(t,e,r){const s=r?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(s);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,i.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,r){super.ensurePacked(t,e,r),this._lineMeshWriter.ensurePacked(t,e,r)}enqueueRequest(t,e,r){super.enqueueRequest(t,e,r),this._lineMeshWriter.enqueueRequest(t,e,r)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},28736:(t,e,r)=>{r.d(e,{By:()=>m,Jb:()=>x,My:()=>u,i8:()=>y,mR:()=>h,qE:()=>f,ue:()=>d,xo:()=>p});var i=r(69539),s=r(50076),n=r(76460),o=r(28808);const a=()=>n.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),c=0,l=100;function u(t,e){return[!!t?.minScale&&e.scaleToZoom(t.minScale)||c,!!t?.maxScale&&e.scaleToZoom(t.maxScale)||l]}function h(t){return 1<<t}function p(t){let e=0;for(const[r,i]of t)i&&(e|=1<<r);return e}function x(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const r=i.A.fromString(t);if(!r)return a().errorOnce(new s.A("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=r.toArray()}else e=t;const[r,n,o,c]=e;return[r*(c/255),n*(c/255),o*(c/255),c]}function d(t){switch(t){case"butt":case o.uT.Butt:return o.xR.BUTT;case"round":case o.uT.Round:return o.xR.ROUND;case"square":case o.uT.Square:return o.xR.SQUARE}}function f(t){switch(t){case"bevel":case o.wd.Bevel:return o.JO.BEVEL;case"miter":case o.wd.Miter:return o.JO.MITER;case"round":case o.wd.Round:return o.JO.ROUND}}function y(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function m(t,e){return Math.round(t*e)/e}},98112:(t,e,r)=>{r.d(e,{h:()=>o});var i=r(12258),s=r(93345);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:s.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:s.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.pe.UNSIGNED_BYTE,count:1},offset:{type:s.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};class o extends i.r{constructor(){super(...arguments),this.vertexSpec=n}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const r=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const i=e.readXForDisplay(),s=e.readYForDisplay();this._writeQuad(t,r,i,s)}else if("esriGeometryMultipoint"===e.geometryType){const i=e.readGeometryForDisplay();i?.forEachVertex(((e,i)=>{e>=0&&e<=512&&i>=0&&i<=512&&this._writeQuad(t,r,e,i)}))}t.recordEnd()}_writeQuad(t,e,r,i){const s=t.vertexCount();this._writeVertex(t,e,r,i),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}}},64346:(t,e,r)=>{r.d(e,{Bw:()=>f,Eq:()=>x});var i=r(76931),s=r(84735),n=r(5095),o=r(27307),a=r(35797),c=r(28736),l=r(12258),u=r(27534),h=r(93345);class p{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const x={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:h.pe.SHORT,count:2,packPrecisionFactor:n.fq,pack:(t,e)=>{let{scaleInfo:r}=t,{tileInfo:i}=e;return(0,c.My)(r,i)}}},attributes:{id:{type:h.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:h.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:h.pe.UNSIGNED_BYTE,count:1},color:{type:h.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,c.Jb)(e)}},offset:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{extrusionOffsetX:e,extrusionOffsetY:r}=t;return[(0,c.By)(e,16),(0,c.By)(r,16)]}},normal:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{normalX:e,normalY:r}=t;return[(0,c.By)(e,16),(0,c.By)(r,16)]}},halfWidth:{type:h.pe.HALF_FLOAT,count:1,pack:t=>{let{width:e}=t;return(0,i.Lz)(.5*e)}},referenceHalfWidth:{type:h.pe.HALF_FLOAT,count:1,pack:t=>{let{referenceWidth:e}=t;return(0,i.Lz)(.5*e)}}}};class d{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class f extends l.r{constructor(t,e,r,i){super(t,e,r,i),this.vertexSpec=x,this._currentWrite=new d,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new p,this._initializeTessellator()}writeLineVertices(t,e,r){const i=this._getLines(e);null!=i&&this._writeVertices(t,r,i)}_initializeTessellator(){this._lineTessellator=new o.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,r){const i=r??s.z.fromFeatureSetReaderCIM(e);i&&this._writeGeometry(t,e,i)}_writeGeometry(t,e,r,i){t.recordStart(this.instanceId,this.attributeLayout,i),this.writeLineVertices(t,r,e),t.recordEnd()}_getLines(t){return(0,a.uS)(t,(0,u.Z0)(this.evaluatedMeshParams))}_writeVertices(t,e,r){const{_currentWrite:s,_tessellationOptions:o,evaluatedMeshParams:a}=this,{width:l,capType:u,joinType:h,miterLimit:p,hasSizeVV:x}=a,d=(0,i.Lz)(.5*l);o.halfWidth=d,o.capType=(0,c.ue)(u),o.joinType=(0,c.qE)(h),o.miterLimit=p;const f=!x;s.out=t,s.id=e.getDisplayId(),s.vertexCount=0,s.indexCount=0,s.vertexFrom=t.vertexCount(),s.vertexBounds=f&&d<n.Gh?0:1;for(const{line:i,start:n}of r)o.initialDistance=n%65535,this._lineTessellator.tessellate(i,o,f)}_writeTesselatedVertex(t,e,r,i,s,n,o,a,c,l,u){const{out:h,id:p,vertexBounds:x}=this._currentWrite;return this.hasEffects&&h.recordBounds(t,e,x,x),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=l,this._tessParams.directionX=s,this._tessParams.directionY=n,this._tessParams.distance=u,this._writeVertex(h,p,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,r){const{out:i}=this._currentWrite;i.indexEnsureSize(3),i.indexWrite(t),i.indexWrite(e),i.indexWrite(r),this._currentWrite.indexCount+=3}}},26455:(t,e,r)=>{r.d(e,{K:()=>u});var i=r(84735),s=r(5095),n=r(28736),o=r(64346),a=r(90113),c=r(93345);const l={createComputedParams:t=>t,optionalAttributes:o.Eq.optionalAttributes,attributes:{...o.Eq.attributes,bitset:{type:c.pe.UNSIGNED_BYTE,count:1,pack:t=>{let{shouldSampleAlphaOnly:e,shouldScaleDash:r,isSDF:i}=t;return(0,n.xo)([[a.cn,e],[a.kx,r],[a.b5,i]])}},tlbr:{type:c.pe.UNSIGNED_SHORT,count:4,pack:t=>{let{sprite:e}=t;const{rect:r,width:i,height:n}=e,o=r.x+s.hM,a=r.y+s.hM;return[o,a,o+i,a+n]}},accumulatedDistance:{type:c.pe.UNSIGNED_SHORT,count:1,packTessellation:t=>{let{distance:e}=t;return e}},segmentDirection:{type:c.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:t=>{let{directionX:e,directionY:r}=t;return[e,r]}}}};class u extends o.Bw{constructor(t,e,r,i){super(t,e,r,i),this.vertexSpec=l,this._tessellationOptions.textured=!0}_write(t,e,r){const s=r??i.z.fromFeatureSetReaderCIM(e);if(!s)return;const{sprite:n}=this.evaluatedMeshParams;this._writeGeometry(t,e,s,n?.textureBinding)}}},4480:(t,e,r)=>{r.d(e,{H:()=>b});var i=r(76931),s=r(94967),n=r(98006),o=r(19555),a=r(84735),c=r(77555),l=r(28808),u=r(33443),h=r(5095),p=r(28736),x=r(97763);class d{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(t){const e=new d(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects),{type:r,width:s,height:n,angle:o,alignment:a,outlineSize:c,referenceSize:l,sprite:u,overrideOutlineColor:h}=t;e.rawWidth=(0,i.Lz)(s),e.rawHeight=(0,i.Lz)(n),e.angle=o,e.alignment=a,e.outlineSize=(0,i.Lz)(c),e.referenceSize=(0,i.Lz)(l),e.overrideOutlineColor=h,e.offsetX=(0,i.Lz)(t.offsetX),e.offsetY=(0,i.Lz)(t.offsetY),"simple"!==r||u.sdf||(e.rawWidth=u.width,e.rawHeight=u.height);return e.sizeRatio=u.sdf?2:1,e._computeSize(t,!1),e}static fromComplexMeshParams(t){const e=new d(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects);let{alignment:r,transforms:s,size:n,scaleX:o,anchorX:a,anchorY:c,angle:l,colorLocked:u,frameHeight:h,widthRatio:p,offsetX:f,offsetY:y,outlineSize:m,referenceSize:_,scaleFactor:g,sizeRatio:v,isAbsoluteAnchorPoint:w,rotateClockwise:b,scaleSymbolsProportionally:k,sprite:T}=t;if(s&&s.infos.length>0){const t=(0,x.zb)(n,l,b,f,y,s);n=t.size,l=t.rotation,f=t.offsetX,y=t.offsetY,b=!1}g&&(n*=g,f*=g,y*=g);const S=o*(T.width/T.height);e.alignment=r,e.rawHeight=(0,i.Lz)(n),e.rawWidth=e.rawHeight*S,e.referenceSize=(0,i.Lz)(_),e.sizeRatio=v,e.angle=l,e.rotateClockwise=b,e.anchorX=a,e.anchorY=c,e.offsetX=(0,i.Lz)(f),e.offsetY=(0,i.Lz)(y),w&&n&&(T.sdf?e.anchorX=a/(n*p):e.anchorX=a/(n*S),e.anchorY=c/n);const P=k&&h?n/h:1;return e.outlineSize=0===m||isNaN(m)?0:(0,i.Lz)(m)*P,e.scaleSymbolsProportionally=k,e.colorLocked=u,e._computeSize(t,!0),e}constructor(t,e,r,i,s,n,o){this.sprite=t,this.color=e,this.outlineColor=r,this.minPixelBuffer=i,this.placement=s,this.scaleInfo=n,this.effects=o,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=l.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:r,hasSizeVV:i}=t,s=!!r.sdf,{rawWidth:n,rawHeight:o,sizeRatio:a,outlineSize:c}=this,l=n*a,u=o*a;if(s&&!i){const t=e&&n>o?l:n,r=o,i=c+2;this.computedWidth=Math.min(t+i,l),this.computedHeight=Math.min(r+i,u)}else this.computedWidth=l,this.computedHeight=u;const p=s?Math.max(r.width,r.height)/Math.max(l,u):1,x=.5*(l-this.computedWidth)*p,d=.5*(u-this.computedHeight)*p,f=r.rect.x+h.hM+x,y=r.rect.y+h.hM+d,m=f+r.width-2*x,_=y+r.height-2*d;this.texXmin=Math.floor(f),this.texYmin=Math.floor(y),this.texXmax=Math.ceil(m),this.texYmax=Math.ceil(_),this.computedWidth*=(this.texXmax-this.texXmin)/(m-f),this.computedHeight*=(this.texYmax-this.texYmin)/(_-y),this.anchorX*=l/this.computedWidth,this.anchorY*=u/this.computedHeight}}var f=r(43282),y=r(64849),m=r(12258),_=r(93345);const g=128/Math.PI;function v(t){return function(t,e){return t%=e,Math.abs(t>=0?t:t+e)}(t*g,256)}const w={createComputedParams:t=>d.from(t),optionalAttributes:{zoomRange:{type:_.pe.SHORT,count:2,packPrecisionFactor:h.fq,pack:(t,e)=>{let{scaleInfo:r}=t,{tileInfo:i}=e;return(0,p.My)(r,i)}}},attributes:{pos:{type:_.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:_.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:_.pe.UNSIGNED_BYTE,count:1,pack:t=>{let{sprite:e,alignment:r,scaleSymbolsProportionally:i,overrideOutlineColor:s,colorLocked:n}=t,o=0;return e.sdf&&(o|=(0,p.mR)(f.c.bitset.isSDF)),r===l.C1.MAP&&(o|=(0,p.mR)(f.c.bitset.isMapAligned)),i&&(o|=(0,p.mR)(f.c.bitset.scaleSymbolsProportionally)),s&&(o|=(0,p.mR)(f.c.bitset.overrideOutlineColor)),n&&(o|=(0,p.mR)(f.c.bitset.colorLocked)),o}},offset:{type:_.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{angle:e,computedWidth:r,computedHeight:i,anchorX:a,anchorY:c,offsetX:l,offsetY:u,rotateClockwise:h}=t;const p=function(t,e,r,i){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=(0,n.vt)(),c=o?1:-1;return(0,s.D_)(a),(e||r)&&(0,s.Tl)(a,a,[e,-r]),i&&(0,s.e$)(a,a,.017453292519944444*c*-i),a}(0,l,u,-e,h),x=-(.5+a)*r,d=-(.5-c)*i,f=[x,d],y=[x+r,d],m=[x,d+i],_=[x+r,d+i];return(0,o.l0)(f,f,p),(0,o.l0)(y,y,p),(0,o.l0)(m,m,p),(0,o.l0)(_,_,p),[f,y,m,_]}}},textureUV:{type:_.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:t=>{let{texXmax:e,texXmin:r,texYmax:i,texYmin:s}=t;return[[r,s],[e,s],[r,i],[e,i]]}}},color:{type:_.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{color:e}=t;return(0,p.Jb)(e)}},outlineColor:{type:_.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{outlineColor:e}=t;return(0,p.Jb)(e)}},sizing:{type:_.pe.UNSIGNED_BYTE,count:4,pack:t=>{let{rawWidth:e,rawHeight:r,outlineSize:i,referenceSize:s}=t;const n=Math.max(e,r);return[(0,p.i8)(n,128),(0,p.i8)(i,128),(0,p.i8)(s,128),0]}},placementAngle:{type:_.pe.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{placementAngle:e}=t;return v(e)}},sizeRatio:{type:_.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:t=>{let{sizeRatio:e}=t;return e}}}};class b extends m.r{constructor(){super(...arguments),this.vertexSpec=w}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,r){const i=this.evaluatedMeshParams.sprite?.textureBinding,s=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,i);const n=this.evaluatedMeshParams.minPixelBuffer,o=Math.max(this.evaluatedMeshParams.computedWidth,n),a=Math.max(this.evaluatedMeshParams.computedHeight,n),l=this.evaluatedMeshParams.offsetX,u=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,r,o,a);else if(r?.nextPath()){r.nextPoint();const e=r.x,i=r.y;t.recordBounds(e+l,i+u,o,a),this._writeQuad(t,s,e,i)}else if("esriGeometryPolygon"===e.geometryType){const r=e.readCentroidForDisplay();if(!r)return;const[i,n]=r.coords;t.recordBounds(i+l,n+u,o,a),this._writeQuad(t,s,i,n)}else if("esriGeometryPoint"===e.geometryType){const r=e.readXForDisplay(),i=e.readYForDisplay();t.recordBounds(r+l,i+u,o,a),this._writeQuad(t,s,r,i)}else{const r=e.readGeometryForDisplay();r?.forEachVertex(((e,r)=>{t.recordBounds(e+l,r+u,o,a),Math.abs(e)>c.s||Math.abs(r)>c.s||this._writeQuad(t,s,e,r)}))}t.recordEnd()}_writePlacedMarkers(t,e,r,s,n){const o=r??a.z.fromFeatureSetReaderCIM(e)?.clone();if(!o)return;const l=u.l.getPlacement(o,-1,this.evaluatedMeshParams.placement,(0,i.Lz)(1),t.id,(0,y.z)());if(!l)return;const h=e.getDisplayId();let p=l.next();const x=this.evaluatedMeshParams.offsetX,d=-this.evaluatedMeshParams.offsetY;for(;null!=p;){const e=p.tx,r=-p.ty;if(Math.abs(e)>c.s||Math.abs(r)>c.s){p=l.next();continue}const i=-p.getAngle();t.recordBounds(e+x,r+d,s,n),this._writeQuad(t,h,e,r,i),p=l.next()}}_writeQuad(t,e,r,i,s){const n=t.vertexCount(),o=null==s?null:{placementAngle:s};this._writeVertex(t,e,r,i,o),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}},12258:(t,e,r)=>{r.d(e,{r:()=>x});var i=r(84735),s=r(81377),n=r(64849),o=r(99588),a=(r(81806),r(27534)),c=r(93345);function l(t){switch(t){case c.pe.BYTE:case c.pe.UNSIGNED_BYTE:return 1;case c.pe.SHORT:case c.pe.UNSIGNED_SHORT:case c.pe.HALF_FLOAT:return 2;case c.pe.FLOAT:case c.pe.INT:case c.pe.UNSIGNED_INT:return 4}}class u{static fromVertexSpec(t,e){const{attributes:r,optionalAttributes:i}=t;let s,n,o;const a=[];for(const l in r){const t=r[l];"position"===t.pack?s={...t,name:l,offset:0}:"id"===t.pack?n={...t,name:l,offset:4}:"bitset"===l?o={...t,name:l,offset:7}:a.push({...t,name:l})}for(const l in i)if(!0===e[l]){const t=i[l];a.push({...t,name:l})}const c=function(t){const e=[],r=[],i=[];for(const s of t){const t=l(s.type)*s.count;switch(t%2||t%4||4){case 4:e.push(s);continue;case 2:r.push(s);continue;case 1:i.push(s);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...r),e.push(...i),e}(a),h=[];let p=8,x=1;for(const u of c)h.push({...u,offset:p}),p+=l(u.type)*u.count,u.packAlternating&&(x=Math.max(u.packAlternating.count,x));const d=Uint32Array.BYTES_PER_ELEMENT,f=p%d;return new u(s,n,o,h,p+(f?d-f:0),x)}constructor(t,e,r,i,s,n){this.position=t,this.id=e,this.bitset=r,this.standardAttributes=i,this.stride=s,this.packVertexCount=n,i.push(r),this._attributes=[t,e,r,...i]}get attributeLayout(){if(!this._attributeLayout){const t=(0,a.hU)(this._attributes),e=this._attributes.map((t=>({name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:t.normalized??!1})));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}}var h=r(70029);class p{static fromVertexSpec(t,e){const r=u.fromVertexSpec(t,e);return new p(r)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,r,i,s,n){for(let o=0;o<this._spec.packVertexCount;o++){const t=o*this._spec.stride;this._packPosition(r,i,t),this._packId(e,t);const a=this._spec.bitset;if(n){if(a.packTessellation){const e=a.packTessellation(n,s);this._pack(e,a,t)}for(const e of this._spec.standardAttributes)if(null!=e.packTessellation){const r=e.packTessellation(n,s);this._pack(r,e,t)}else if(e.packAlternating?.packTessellation){const t=e.packAlternating.packTessellation(n,s);for(let r=0;r<this._spec.packVertexCount;r++){const i=t[r];this._pack(i,e,r*this._spec.stride)}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const r of this._spec.standardAttributes)if(r.pack&&"string"!=typeof r.pack){const i=r.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(i,r,t*this._spec.stride)}else if(r.packAlternating?.pack){const i=r.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=i[t];this._pack(e,r,t*this._spec.stride)}}}_packPosition(t,e,r){const{offset:i}=this._spec.position,s=this._spec.position.packPrecisionFactor??1,n=(0,o.M9)(t*s,e*s);this._dataView.setUint32(r+i,n,!0)}_packId(t,e){const r=t*(this._spec.id.packPrecisionFactor??1),i=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,r|i,!0)}_pack(t,e,r){(0,h.F)(this._dataView,t,e,r)}}class x{constructor(t,e,r,i){this._instanceId=t,this._evaluator=e,this._enabledOptionalAttributes=r,this._viewParams=i,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=p.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){(function(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(this._evaluator.inputMeshParams.effects?.effectInfos)&&await(0,n.R)()}enqueueRequest(t,e,r){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,r)}write(t,e,r,o,a){this.ensurePacked(e,r,o);const c=this.evaluatedMeshParams.effects;if(!c||0===c.length)return void this._write(t,r,void 0,a);const l=r.readGeometryForDisplay()?.clone();if(!l)return;const u=i.z.fromOptimizedCIM(l,r.geometryType),h=(0,n.z)();u.invertY();const p=t.id||"",x=s.V.executeEffects(c,u,p,h);let d;for(;d=x.next();)d.invertY(),this._write(t,r,d,a)}ensurePacked(t,e,r){if(!this._evaluator.hasDynamicProperties)return;const i=this._evaluator.evaluateMeshParams(t,e,r);this._vertexPack.pack(i,this._viewParams)}_writeVertex(t,e,r,i,s){const n=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,r,i,n,s)}}},64849:(t,e,r)=>{r.d(e,{R:()=>n,z:()=>s});let i=null;function s(){return i}async function n(){i=await Promise.all([r.e(2612),r.e(4050)]).then(r.bind(r,1669))}},41406:(t,e,r)=>{r.d(e,{v:()=>c});var i=r(76931),s=r(28736),n=r(12258),o=r(93345);const a={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:o.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:o.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:t=>{let{size:e}=t;const r=(0,i.Lz)(e),s=-r/2,n=-r/2;return[[s,n],[s+r,n],[s,n+r],[s+r,n+r]]}}},texCoords:{type:o.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:o.pe.UNSIGNED_BYTE,count:2,pack:t=>{let{size:e}=t;return[e,e]}},referenceSize:{type:o.pe.UNSIGNED_BYTE,count:1,pack:t=>{let{size:e}=t;return(0,i.Lz)(e)}},zoomRange:{type:o.pe.UNSIGNED_BYTE,count:2,pack:(t,e)=>{let{scaleInfo:r}=t,{tileInfo:i}=e;return(0,s.My)(r,i)}}}};class c extends n.r{constructor(){super(...arguments),this.vertexSpec=a}_write(t,e){const r=e.getDisplayId(),s=this.evaluatedMeshParams.minPixelBuffer,n=Math.max((0,i.Lz)(this.evaluatedMeshParams.size),s);let o,a;if("esriGeometryPoint"===e.geometryType)o=e.readXForDisplay(),a=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;o=t?.coords[0],a=t?.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(o,a,n,n);const c=t.vertexCount();this._writeVertex(t,r,o,a),t.indexWrite(c+0),t.indexWrite(c+1),t.indexWrite(c+2),t.indexWrite(c+1),t.indexWrite(c+3),t.indexWrite(c+2),t.recordEnd()}}},81615:(t,e,r)=>{r.d(e,{G8:()=>L,GJ:()=>m});var i=r(15941),s=r(76931),n=r(84735),o=r(33443),a=r(71447),c=r(5095),l=r(40392),u=r(28736),h=r(64849),p=r(12258),x=r(90113),d=r(97763);class f{constructor(t){const{offsetX:e,offsetY:r,postAngle:i,fontSize:s,scaleFactor:n,transforms:o}=t;if(this.offsetX=e,this.offsetY=r,this.postAngle=i,this.fontSize=Math.min(s,96),this.transforms=o,o&&o.infos.length>1){const t=(0,d.zb)(s,i,!1,e,r,o);this.fontSize=Math.min(t.size,96),this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}n&&(this.fontSize*=n,this.offsetX*=n,this.offsetY*=n)}}var y=r(93345);const m=28,_=[4,4],g=[16,4],v={topLeft:g,topRight:g,bottomLeft:g,bottomRight:g},w=[4,2],b=[4,6],k={topLeft:w,topRight:w,bottomLeft:b,bottomRight:b},T={topLeft:w,topRight:b,bottomLeft:w,bottomRight:b},S={topLeft:b,topRight:b,bottomLeft:_,bottomRight:_},P={topLeft:_,topRight:_,bottomLeft:b,bottomRight:b},z={topLeft:b,topRight:_,bottomLeft:b,bottomRight:_},E={topLeft:_,topRight:b,bottomLeft:_,bottomRight:b},M={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:y.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:c.fq,packTessellation:t=>{let{minZoom:e,maxZoom:r}=t;return[e||0,r||m]}},clipAngle:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{clipAngle:e}=t;return N(e||0)}},referenceSymbol:{type:y.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{if(!t.referenceBounds)return[0,0,0,0];const r=(0,a.iT)(e.horizontalAlignment),i=(0,a.Dy)(e.verticalAlignment),{offsetX:n,offsetY:o,size:c}=t.referenceBounds;return[(0,s.Lz)(n),-(0,s.Lz)(o),(0,s.Lz)(c),r+1<<2|i+1]}}},attributes:{pos:{type:y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:t=>{let{isBackground:e,mapAligned:r}=t;return(0,u.xo)([[x.bg,e],[x.ti,!!r]])}},offset:{type:y.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:t=>{let{offsets:e}=t;const{bottomLeft:r,bottomRight:i,topLeft:s,topRight:n}=e;return[s,n,r,i]}}},textureUV:{type:y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:t=>{let{texcoords:e}=t;const{bottomLeft:r,bottomRight:i,topLeft:s,topRight:n}=e;return[s,n,r,i]}}},color:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:t=>{let{color:e}=t;return e}},fontSize:{type:y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:t=>{let{fontSize:e}=t;return(0,s.Lz)(e)}},referenceSize:{type:y.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:(t,e)=>{let{fontSize:r}=t,{referenceSize:i}=e;return(0,s.Lz)(i??r)}},haloColor:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:t=>{let{haloColor:e}=t;return(0,u.Jb)(e)}},haloFontSize:{type:y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:t=>{let{haloFontSize:e}=t;return(0,s.Lz)(e)}}}};class L extends p.r{constructor(){super(...arguments),this.vertexSpec=M,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,r){super.ensurePacked(t,e,r),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new f(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,r){const i=this._getShaping();if(!i)return;const s=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,i,r);if(r?.nextPath())return r.nextPoint(),this._writeGlyphs(t,s,r.x,r.y,i,0);if("esriGeometryPolygon"===e.geometryType){const r=e.readCentroidForDisplay();if(!r)return;const[n,o]=r.coords;return this._writeGlyphs(t,s,n,o,i,0)}if("esriGeometryMultipoint"===e.geometryType){const r=e.readGeometryForDisplay();return void r?.forEachVertex(((e,r)=>this._writeGlyphs(t,s,e,r,i,0)))}const n=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,s,n,o,i,0)}_writePlacedTextMarkers(t,e,r,i){const a=i??n.z.fromFeatureSetReaderCIM(e);if(!a)return;const c=o.l.getPlacement(a,-1,this.evaluatedMeshParams.placement,(0,s.Lz)(1),t.id,(0,h.z)());if(!c)return;const l=e.getDisplayId();let u=c.next();for(;null!=u;){const e=u.tx,i=-u.ty,s=-u.getAngle();this._writeGlyphs(t,l,e,i,r,s),u=c.next()}}_getShaping(t){const e=this._textMeshTransformProps,r=this.evaluatedMeshParams;if(!r.glyphs?.glyphs.length)return null;const n=Math.round((0,s.Lz)(e.fontSize)),o=(0,s.Lz)(e.offsetX),a=(0,s.Lz)(e.offsetY),u=(0,i.qE)((0,s.Lz)(r.lineWidth),c.GR,c.cp),h=c.DY*(0,i.qE)(r.lineHeightRatio,.25,4);return(0,l.Tl)(r.glyphs,{scale:n/c.eG,angle:e.postAngle,xOffset:o,yOffset:a,horizontalAlignment:r.horizontalAlignment,verticalAlignment:t||r.verticalAlignment,maxLineWidth:u,lineHeight:h,decoration:r.decoration,borderLineSizePx:(0,s.Lz)(r.boxBorderLineSize),hasBackground:!!r.boxBackgroundColor,useCIMAngleBehavior:r.useCIMAngleBehavior})}_writeGlyphs(t,e,r,i,n,o,a,c){const l=this.evaluatedMeshParams,h=this._textMeshTransformProps,p=h.fontSize,x=(0,s.Lz)(h.offsetX),d=(0,s.Lz)(h.offsetY),[f,y]=(0,u.My)(l.scaleInfo,this.getTileInfo());0!==o&&n.setRotation(o);const m=n.bounds,_=r+m.x+x,g=i+m.y-d,v=2*(l.minPixelBuffer?l.minPixelBuffer/p:1),w=Math.max(m.width,m.height)*v;n.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding),t.recordBounds(_,g,w,w),this._writeTextBox(t,e,r,i,n.textBox,a,c),t.recordEnd());for(const s of n.glyphs){t.recordStart(this.instanceId,this.attributeLayout,s.textureBinding),t.recordBounds(_,g,w,w);const{texcoords:n,offsets:o}=s;this._writeQuad(t,e,r,i,{texcoords:n,offsets:o,fontSize:p,color:(0,u.Jb)(l.color),isBackground:!1,referenceBounds:a,minZoom:f,maxZoom:y,...c}),t.recordEnd()}0!==o&&n.setRotation(-o)}_writeTextBox(t,e,r,i,s,n,o){const a=this.evaluatedMeshParams,{fontSize:c}=this._textMeshTransformProps,{boxBackgroundColor:l,boxBorderLineColor:h}=a,p={isBackground:!0,fontSize:c,referenceBounds:n,...o};l&&(this._writeQuad(t,e,r,i,{texcoords:v,offsets:s.main,color:(0,u.Jb)(l),...p}),h||(this._writeQuad(t,e,r,i,{texcoords:S,offsets:s.top,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,r,i,{texcoords:P,offsets:s.bot,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,r,i,{texcoords:z,offsets:s.left,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,r,i,{texcoords:E,offsets:s.right,color:(0,u.Jb)(l),...p}))),h&&(this._writeQuad(t,e,r,i,{texcoords:k,offsets:s.top,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,r,i,{texcoords:k,offsets:s.bot,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,r,i,{texcoords:T,offsets:s.left,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,r,i,{texcoords:T,offsets:s.right,color:(0,u.Jb)(h),...p}))}_writeQuad(t,e,r,i,s){const n=t.vertexCount();this._writeVertex(t,e,r,i,s),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}const N=t=>Math.round(t*(254/360))}}]);
//# sourceMappingURL=9076.37d62168.chunk.js.map